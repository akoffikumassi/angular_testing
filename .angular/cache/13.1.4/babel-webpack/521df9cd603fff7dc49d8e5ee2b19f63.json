{"ast":null,"code":"import { asyncData, ActivatedRouteStub } from '../../testing';\nimport { HeroDetailComponent } from './hero-detail.component'; //////////  Tests  ////////////////////\n\ndescribe('HeroDetailComponent - no TestBed', () => {\n  let comp;\n  let expectedHero;\n  let hds;\n  let router;\n  beforeEach(done => {\n    expectedHero = {\n      id: 42,\n      name: 'Bubba'\n    };\n    const activatedRoute = new ActivatedRouteStub({\n      id: expectedHero.id\n    });\n    router = jasmine.createSpyObj('Router', ['navigate']);\n    hds = jasmine.createSpyObj('HeroDetailService', ['getHero', 'saveHero']);\n    hds.getHero.and.returnValue(asyncData(expectedHero));\n    hds.saveHero.and.returnValue(asyncData(expectedHero));\n    comp = new HeroDetailComponent(hds, activatedRoute, router);\n    comp.ngOnInit(); // OnInit calls HDS.getHero; wait for it to get the fake hero\n\n    hds.getHero.calls.first().returnValue.subscribe(done);\n  });\n  it('should expose the hero retrieved from the service', () => {\n    expect(comp.hero).toBe(expectedHero);\n  });\n  it('should navigate when click cancel', () => {\n    comp.cancel();\n    expect(router.navigate.calls.any()).toBe(true, 'router.navigate called');\n  });\n  it('should save when click save', () => {\n    comp.save();\n    expect(hds.saveHero.calls.any()).toBe(true, 'HeroDetailService.save called');\n    expect(router.navigate.calls.any()).toBe(false, 'router.navigate not called yet');\n  });\n  it('should navigate when click save resolves', done => {\n    comp.save(); // waits for async save to complete before navigating\n\n    hds.saveHero.calls.first().returnValue.subscribe(() => {\n      expect(router.navigate.calls.any()).toBe(true, 'router.navigate called');\n      done();\n    });\n  });\n});","map":{"version":3,"sources":["/home/yadadev/work/trainings/mean/angular/angular_testing/src/app/hero/hero-detail.component.no-testbed.spec.ts"],"names":["asyncData","ActivatedRouteStub","HeroDetailComponent","describe","comp","expectedHero","hds","router","beforeEach","done","id","name","activatedRoute","jasmine","createSpyObj","getHero","and","returnValue","saveHero","ngOnInit","calls","first","subscribe","it","expect","hero","toBe","cancel","navigate","any","save"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,kBAApB,QAA8C,eAA9C;AACA,SAASC,mBAAT,QAAoC,yBAApC,C,CACA;;AACAC,QAAQ,CAAC,kCAAD,EAAqC,MAAM;AAC/C,MAAIC,IAAJ;AACA,MAAIC,YAAJ;AACA,MAAIC,GAAJ;AACA,MAAIC,MAAJ;AACAC,EAAAA,UAAU,CAAEC,IAAD,IAAU;AACjBJ,IAAAA,YAAY,GAAG;AAAEK,MAAAA,EAAE,EAAE,EAAN;AAAUC,MAAAA,IAAI,EAAE;AAAhB,KAAf;AACA,UAAMC,cAAc,GAAG,IAAIX,kBAAJ,CAAuB;AAAES,MAAAA,EAAE,EAAEL,YAAY,CAACK;AAAnB,KAAvB,CAAvB;AACAH,IAAAA,MAAM,GAAGM,OAAO,CAACC,YAAR,CAAqB,QAArB,EAA+B,CAAC,UAAD,CAA/B,CAAT;AACAR,IAAAA,GAAG,GAAGO,OAAO,CAACC,YAAR,CAAqB,mBAArB,EAA0C,CAAC,SAAD,EAAY,UAAZ,CAA1C,CAAN;AACAR,IAAAA,GAAG,CAACS,OAAJ,CAAYC,GAAZ,CAAgBC,WAAhB,CAA4BjB,SAAS,CAACK,YAAD,CAArC;AACAC,IAAAA,GAAG,CAACY,QAAJ,CAAaF,GAAb,CAAiBC,WAAjB,CAA6BjB,SAAS,CAACK,YAAD,CAAtC;AACAD,IAAAA,IAAI,GAAG,IAAIF,mBAAJ,CAAwBI,GAAxB,EAA6BM,cAA7B,EAA6CL,MAA7C,CAAP;AACAH,IAAAA,IAAI,CAACe,QAAL,GARiB,CASjB;;AACAb,IAAAA,GAAG,CAACS,OAAJ,CAAYK,KAAZ,CAAkBC,KAAlB,GAA0BJ,WAA1B,CAAsCK,SAAtC,CAAgDb,IAAhD;AACH,GAXS,CAAV;AAYAc,EAAAA,EAAE,CAAC,mDAAD,EAAsD,MAAM;AAC1DC,IAAAA,MAAM,CAACpB,IAAI,CAACqB,IAAN,CAAN,CAAkBC,IAAlB,CAAuBrB,YAAvB;AACH,GAFC,CAAF;AAGAkB,EAAAA,EAAE,CAAC,mCAAD,EAAsC,MAAM;AAC1CnB,IAAAA,IAAI,CAACuB,MAAL;AACAH,IAAAA,MAAM,CAACjB,MAAM,CAACqB,QAAP,CAAgBR,KAAhB,CAAsBS,GAAtB,EAAD,CAAN,CAAoCH,IAApC,CAAyC,IAAzC,EAA+C,wBAA/C;AACH,GAHC,CAAF;AAIAH,EAAAA,EAAE,CAAC,6BAAD,EAAgC,MAAM;AACpCnB,IAAAA,IAAI,CAAC0B,IAAL;AACAN,IAAAA,MAAM,CAAClB,GAAG,CAACY,QAAJ,CAAaE,KAAb,CAAmBS,GAAnB,EAAD,CAAN,CAAiCH,IAAjC,CAAsC,IAAtC,EAA4C,+BAA5C;AACAF,IAAAA,MAAM,CAACjB,MAAM,CAACqB,QAAP,CAAgBR,KAAhB,CAAsBS,GAAtB,EAAD,CAAN,CAAoCH,IAApC,CAAyC,KAAzC,EAAgD,gCAAhD;AACH,GAJC,CAAF;AAKAH,EAAAA,EAAE,CAAC,0CAAD,EAA8Cd,IAAD,IAAU;AACrDL,IAAAA,IAAI,CAAC0B,IAAL,GADqD,CAErD;;AACAxB,IAAAA,GAAG,CAACY,QAAJ,CAAaE,KAAb,CAAmBC,KAAnB,GAA2BJ,WAA3B,CACKK,SADL,CACe,MAAM;AACjBE,MAAAA,MAAM,CAACjB,MAAM,CAACqB,QAAP,CAAgBR,KAAhB,CAAsBS,GAAtB,EAAD,CAAN,CAAoCH,IAApC,CAAyC,IAAzC,EAA+C,wBAA/C;AACAjB,MAAAA,IAAI;AACP,KAJD;AAKH,GARC,CAAF;AASH,CAtCO,CAAR","sourcesContent":["import { asyncData, ActivatedRouteStub } from '../../testing';\nimport { HeroDetailComponent } from './hero-detail.component';\n//////////  Tests  ////////////////////\ndescribe('HeroDetailComponent - no TestBed', () => {\n    let comp;\n    let expectedHero;\n    let hds;\n    let router;\n    beforeEach((done) => {\n        expectedHero = { id: 42, name: 'Bubba' };\n        const activatedRoute = new ActivatedRouteStub({ id: expectedHero.id });\n        router = jasmine.createSpyObj('Router', ['navigate']);\n        hds = jasmine.createSpyObj('HeroDetailService', ['getHero', 'saveHero']);\n        hds.getHero.and.returnValue(asyncData(expectedHero));\n        hds.saveHero.and.returnValue(asyncData(expectedHero));\n        comp = new HeroDetailComponent(hds, activatedRoute, router);\n        comp.ngOnInit();\n        // OnInit calls HDS.getHero; wait for it to get the fake hero\n        hds.getHero.calls.first().returnValue.subscribe(done);\n    });\n    it('should expose the hero retrieved from the service', () => {\n        expect(comp.hero).toBe(expectedHero);\n    });\n    it('should navigate when click cancel', () => {\n        comp.cancel();\n        expect(router.navigate.calls.any()).toBe(true, 'router.navigate called');\n    });\n    it('should save when click save', () => {\n        comp.save();\n        expect(hds.saveHero.calls.any()).toBe(true, 'HeroDetailService.save called');\n        expect(router.navigate.calls.any()).toBe(false, 'router.navigate not called yet');\n    });\n    it('should navigate when click save resolves', (done) => {\n        comp.save();\n        // waits for async save to complete before navigating\n        hds.saveHero.calls.first().returnValue\n            .subscribe(() => {\n            expect(router.navigate.calls.any()).toBe(true, 'router.navigate called');\n            done();\n        });\n    });\n});\n"]},"metadata":{},"sourceType":"module"}